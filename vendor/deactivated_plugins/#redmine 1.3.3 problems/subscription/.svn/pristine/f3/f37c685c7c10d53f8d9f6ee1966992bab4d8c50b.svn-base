<% unless defined? @count %>
  <% @count = ProjectSubscriber.count(:conditions => { :project_id => @project }) %>
<% end %>

<div id="subscribe-register">

  <h3>
    <%= l(:label_subscription) %>
    <% if User.current.allowed_to?(:view_number_of_subscribers, @project) && @count > 0 %>
      (<%= @count %>)
    <% end %>
  </h3>

  <% form_tag({ :controller => 'account', :action=> 'register' }, :onsubmit => "var user_mail = $('user_mail'); if (user_mail.value == 'user@host') { user_mail.value = ''; }") do %>
    <p><%= l(:text_register_or_login_to_subscribe) %></p>
    <p><%= text_field_tag('user[mail]', 'user@host', :size => 30, :class => 'empty', :onfocus => "var user_mail = $('user_mail'); user_mail.className = ''; if (user_mail.value == 'user@host') { user_mail.value = ''; }") %></p>
    <p>
      <%= submit_tag(l(:label_register), :class => 'small') %>
      <%= link_to(l(:label_login), url_for(:controller => 'account', :action => 'login')) %>
    </p>
  <% end %>

</div>
